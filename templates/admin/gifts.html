{% extends "base.html" %}

{% block title %}Spravova≈• Darceky pre {{ child.name }}{% endblock %}

{% block content %}
<div class="page-header">
    <a href="{{ url_for('admin_dashboard') }}" class="back-link">‚Üê Sp√§≈• na Spr√°vny Panel</a>
    <h1 class="page-title">Spravova≈• Darceky pre {{ child.name }}</h1>
    <a href="{{ url_for('admin_add_gift', child_id=child.id) }}" class="btn btn-primary">+ Prida≈• Darƒçek</a>
</div>

{% if child.gifts %}
    <div class="admin-table">
        <table class="table">
            <thead>
                <tr>
                    <th>Obr√°zok</th>
                    <th>N√°zov Darƒçeka</th>
                    <th>Popis</th>
                    <th>Stav</th>
                    <th>K√∫pil/a</th>
                    <th>Akcie</th>
                </tr>
            </thead>
            <tbody>
                {% for gift in child.gifts %}
                <tr class="{% if gift.is_purchased %}row-purchased{% endif %}">
                    <td class="gift-image-cell">
                        {% if gift.image_url %}
                            <img src="{{ gift.image_url }}" alt="{{ gift.name }}" class="gift-image-tile" onerror="this.style.display='none'">
                        {% else %}
                            <div class="gift-image-placeholder">üì¶</div>
                        {% endif %}
                    </td>
                    <td class="gift-name-cell">{{ gift.name }}</td>
                    <td class="description-cell">
                        {% if gift.description %}
                            {{ gift.description[:50] }}{% if gift.description|length > 50 %}...{% endif %}
                        {% else %}
                            -
                        {% endif %}
                    </td>
                    <td>
                        {% if gift.is_purchased %}
                            <span class="status-badge status-purchased">K√∫pen√©</span>
                        {% else %}
                            <span class="status-badge status-available">Dostupn√©</span>
                        {% endif %}
                    </td>
                    <td>{{ gift.purchased_by if gift.purchased_by else '-' }}</td>
                    <td class="actions-cell">
                        <a href="{{ url_for('admin_edit_gift', gift_id=gift.id) }}" class="btn btn-small btn-secondary">Upravi≈•</a>
                        <form method="POST" action="{{ url_for('admin_delete_gift', gift_id=gift.id) }}" style="display: inline;" onsubmit="return confirm('Vymaza≈• tento darƒçek?');">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                            <button type="submit" class="btn btn-small btn-danger">Vymaza≈•</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% else %}
    <div class="empty-state">
        <div class="empty-icon">üéÅ</div>
        <h2>Zatiaƒæ ≈Ωiadne Darceky</h2>
        <p>Pridajte prv√Ω darƒçek do zoznamu {{ child.name }}</p>
        <a href="{{ url_for('admin_add_gift', child_id=child.id) }}" class="btn btn-primary">+ Prida≈• Darƒçek</a>
    </div>
{% endif %}
{% endblock %}
